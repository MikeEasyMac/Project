<h2>Resources</h2>

<form action="/resources" method="GET" class="mb-4">
    <div class="input-group">
        <input type="text" name="search" class="form-control" placeholder="Search by keyword or tags" value="<%= search || '' %>">
        <select name="course_id" class="form-select">
            <option value="">All Courses</option>
            <% courses.forEach(course => { %>
                <option value="<%= course.id %>" <%= course_id == course.id ? 'selected' : '' %>><%= course.title %></option>
            <% }); %>
        </select>
        <button type="submit" class="btn btn-primary">Search</button>
    </div>
</form>

<a href="/resources/publish" class="btn btn-success mb-3">Publish New Resource</a>

<% if (resources.length > 0) { %>
  <ul class="list-group">
    <% resources.forEach(function(resource) { %>
      <li class="list-group-item mb-3">
        <h4><%= resource.title %></h4>
        <p><strong>Course:</strong> <%= resource.course_title || 'N/A' %></p>
        <p><strong>Type:</strong> <%= resource.type %></p>
        <% if (resource.type === 'link') { %>
          <p><strong>Link:</strong> <a href="<%= resource.content %>" target="_blank"><%= resource.content %></a></p>
        <% } else { %>
          <p><strong>Content:</strong> <%= resource.content %></p>
        <% } %>
        <p><strong>Tags:</strong> <%= resource.tags ? JSON.parse(resource.tags).join(', ') : 'N/A' %></p>
        <p><strong>Published by:</strong> <%= resource.publisher_name %> on <%= new Date(resource.created_at).toLocaleString() %></p>
      </li>
    <% }); %>
  </ul>
<% } else { %>
  <p class="text-muted">No resources found.</p>
<% } %>