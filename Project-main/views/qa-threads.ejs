<div class="container mt-5">
  <div class="row mb-4 align-items-center">
      <div class="col-md-8">
          <h1 class="fw-bold text-white mb-0">Community Q&A</h1>
          <p class="text-white-50">Ask questions, find answers, and collaborate.</p>
      </div>
      <div class="col-md-4 text-end">
          <a href="/qa/create" class="btn btn-light fw-bold text-primary shadow-sm">
              <i class="fas fa-plus me-2"></i>Ask a Question
          </a>
      </div>
  </div>

  <div class="card border-0 shadow-lg mb-5">
      <div class="card-body p-4">
          <form action="/qa" method="GET" class="row g-3">
              <div class="col-md-7">
                  <div class="input-group">
                      <span class="input-group-text bg-white border-end-0"><i class="fas fa-search text-muted"></i></span>
                      <input type="text" name="search" class="form-control border-start-0 ps-0" placeholder="Search topics..." value="<%= search || '' %>">
                  </div>
              </div>
              <div class="col-md-3">
                  <select name="course_id" class="form-select">
                      <option value="">All Courses</option>
                      <% courses.forEach(function(c) { %>
                          <option value="<%= c.id %>" <%= course_id == c.id ? 'selected' : '' %>><%= c.title %></option>
                      <% }); %>
                  </select>
              </div>
              <div class="col-md-2 d-grid">
                  <button type="submit" class="btn btn-primary fw-bold">Filter</button>
              </div>
          </form>
      </div>
  </div>

  <div class="row g-4">
      <% if (qaThreads && qaThreads.length > 0) { %>
          <% qaThreads.forEach(function(thread) { %>
              <div class="col-12">
                  <div class="card border-0 shadow-sm mb-3">
                      <div class="card-body p-4">
                          <div class="d-flex justify-content-between">
                              <div>
                                  <% if (thread.course_title) { %>
                                      <span class="badge bg-primary bg-opacity-10 text-primary mb-2">
                                          <%= thread.course_title %>
                                      </span>
                                  <% } else { %>
                                      <span class="badge bg-secondary bg-opacity-10 text-secondary mb-2">General</span>
                                  <% } %>
                                  
                                  <h4 class="mb-2">
                                      <a href="/qa/threads/<%= thread.id %>" class="text-decoration-none fw-bold text-dark stretched-link">
                                          <%= thread.title %>
                                      </a>
                                  </h4>
                                  
                                  <div class="d-flex align-items-center small text-muted mt-3">
                                      <div class="avatar-small bg-light text-primary rounded-circle me-2 d-flex align-items-center justify-content-center fw-bold" style="width:24px; height:24px;">
                                          <%= thread.creator_name.charAt(0) %>
                                      </div>
                                      <span>Posted by <strong><%= thread.creator_name %></strong> &bull; <%= new Date(thread.created_at).toLocaleDateString() %></span>
                                  </div>
                              </div>

                              <div class="text-center ms-4 d-flex flex-column justify-content-center">
                                  <div class="fs-4 fw-bold text-primary mb-0"><%= thread.reply_count || 0 %></div>
                                  <small class="text-muted text-uppercase" style="font-size: 0.7rem;">Replies</small>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          <% }); %>
      <% } else { %>
          <div class="col-12 text-center py-5">
              <div class="text-white opacity-50 display-1 mb-3">ðŸ’¬</div>
              <h3 class="text-white">No discussions found.</h3>
              <p class="text-white-50">Be the first to ask a question!</p>
          </div>
      <% } %>
  </div>
</div>