<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="mb-4">
                <a href="/resources" class="text-white text-decoration-none fw-bold">
                    <i class="fas fa-arrow-left me-2"></i>Back to Resources
                </a>
            </div>

            <div class="card border-0 shadow-lg">
                <div class="card-body p-5">
                    <h2 class="fw-bold text-dark mb-4">Publish New Resource</h2>
                    <p class="text-muted mb-4">Share study materials with your specific class.</p>
                    
                    <form action="/resources" method="POST">
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold text-dark">Resource Title</label>
                            <input type="text" name="title" class="form-control form-control-lg" placeholder="e.g. Calculus I Formula Sheet" required>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold text-dark">Select Class</label>
                            
                            <% if (courses.length === 1) { %>
                                <select name="course_id" class="form-select" required>
                                    <option value="<%= courses[0].id %>" selected><%= courses[0].title %></option>
                                </select>
                                <div class="form-text text-success"><i class="fas fa-check-circle me-1"></i> Automatically selected your assigned course.</div>
                            
                            <% } else if (courses.length > 1) { %>
                                <select name="course_id" class="form-select" required>
                                    <option value="" disabled selected>Select which of your classes this is for...</option>
                                    <% courses.forEach(function(c) { %>
                                        <option value="<%= c.id %>"><%= c.title %></option>
                                    <% }); %>
                                </select>
                                <div class="form-text">You teach multiple classes. Please choose the correct one.</div>

                            <% } else { %>
                                <select name="course_id" class="form-select" disabled>
                                    <option>No courses assigned to you.</option>
                                </select>
                                <div class="form-text text-danger">Error: You are not linked to any courses in the database.</div>
                            <% } %>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold text-dark">Resource Type</label>
                            <div class="d-flex gap-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="type" id="typeLink" value="link" checked onchange="toggleContentField()">
                                    <label class="form-check-label" for="typeLink">External Link (URL)</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="type" id="typeText" value="text" onchange="toggleContentField()">
                                    <label class="form-check-label" for="typeText">Text Note</label>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label id="contentLabel" class="form-label fw-bold text-dark">Link URL</label>
                            <input type="text" name="content" id="contentInput" class="form-control" placeholder="https://..." required>
                            <textarea name="content" id="contentTextarea" class="form-control d-none" rows="6" placeholder="Type your notes here..." disabled></textarea>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold text-dark">Tags (comma separated)</label>
                            <input type="text" name="tags" class="form-control" placeholder="e.g. math, formulas, exam-prep">
                        </div>

                        <div class="d-grid mt-5">
                            <button type="submit" class="btn btn-primary btn-lg fw-bold">Publish Resource</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleContentField() {
        const isLink = document.getElementById('typeLink').checked;
        const label = document.getElementById('contentLabel');
        const input = document.getElementById('contentInput');
        const textarea = document.getElementById('contentTextarea');

        if (isLink) {
            label.textContent = "Link URL";
            input.classList.remove('d-none');
            input.disabled = false;
            textarea.classList.add('d-none');
            textarea.disabled = true;
        } else {
            label.textContent = "Note Content";
            input.classList.add('d-none');
            input.disabled = true;
            textarea.classList.remove('d-none');
            textarea.disabled = false;
        }
    }
</script>